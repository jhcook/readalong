# US8.1: Save Alignment Maps Locally

## State
DRAFT

## Problem Statement
Re-calculating alignment (STT + Timestamping) every time a story is opened is wasteful and slow. We need to persist this data efficiently.

## User Story
As a system I want to store alignment data So that playback is fast on repeat reads.

## Acceptance Criteria
- [ ] **AC1**: Alignment maps stored in IndexedDB (browser).
- [ ] **AC2**: Alignment maps stored in secure storage (mobile).
- [ ] **AC3**: Storage is versioned.

## Non-Functional Requirements
- Storage Efficiency (Compression if maps are large)
### Security
- [ ] No PII in logs
- [ ] No secrets in code
- [ ] Compliance docs checked if applicable
### Compliance
- [ ] No PII in logs
- [ ] No secrets in code
- [ ] Compliance docs checked if applicable
### Observability
- [ ] Is OpenTelemetry added for new flows?
- [ ] Are logs structured and governed?

## Linked ADRs
- ADR-007: Use IndexedDB and Secure Mobile Storage
- ADR-009: Use a Unified Alignment Map Format

## Impact Analysis Summary
Components touched: Storage Service, Data Layer
Workflows affected: Load Story, Save Story
Risks identified: Schema migration issues if alignment map format changes.
**Architect Governance**:
- [ ] Do ADRs exist for major changes?
- [ ] Are architectural boundaries respected?
**Product Governance**:
- [ ] Are Acceptance Criteria clear and testable?
- [ ] Is the Impact Analysis complete?

## Test Strategy
How will we verify correctness?
- Verify data persistence after browser close / app restart.
- Test storage quota limits.
- Test migration logic (v1 -> v2 schema).

**QA Governance**:
- [ ] Are there new tests for new features?
- [ ] Is the Test Strategy section in the Story comprehensive?

## Rollback Plan
How do we revert safely?
- Clear invalid cache entries.
