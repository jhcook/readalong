
> readalong-extension@0.1.0 test
> jest

PASS src/content/tokenizer.test.ts
PASS src/content/audio/SttEngine.test.ts
PASS src/content/audio/ChunkManager.test.ts
PASS src/popup/Popup.test.tsx
PASS src/background/index.test.ts
PASS src/content/services/ElevenLabsClient.test.ts
PASS src/content/ReadingPane.accessibility.test.tsx
PASS src/content/ReadingPane.chunking.test.tsx
  ● Console

    console.warn
      Offscreen playback failed, switching to fallback Error: Force fallback
          at /Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:191:40
          at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.chunking.test.tsx:38:17)
          at /Users/jcook/repo/readalong/web/extension/node_modules/jest-mock/build/index.js:397:39
          at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/node_modules/jest-mock/build/index.js:404:13)
          at Object.mockConstructor [as sendMessage] (/Users/jcook/repo/readalong/web/extension/node_modules/jest-mock/build/index.js:108:19)
          at /Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:185:40
          at new Promise (<anonymous>)
          at ElevenLabsProvider.playChunk (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:184:27)
          at ElevenLabsProvider.play (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:147:9)

      196 |                     });
      197 |                 } catch (err) {
    > 198 |                     console.warn("Offscreen playback failed, switching to fallback", err);
          |                             ^
      199 |                     this.useFallback = true;
      200 |                     await this.playLocalAudio(chunk.audioId!, startTime);
      201 |                 }

      at ElevenLabsProvider.playChunk (src/content/providers/ElevenLabsProvider.ts:198:29)
      at ElevenLabsProvider.play (src/content/providers/ElevenLabsProvider.ts:147:9)

    console.log
      Prefetching chunk 1

      at ElevenLabsProvider.prefetchChunk (src/content/providers/ElevenLabsProvider.ts:252:21)

PASS src/content/alignment/Aligner.test.ts
  ● Console

    console.debug
      Skipped 1 reference words (paraphrasing/deletion).

      at Aligner.align (src/content/alignment/Aligner.ts:55:19)

    console.debug
      Unmatched recognized word: "um" (insertion/filler).

      at Aligner.align (src/content/alignment/Aligner.ts:69:17)

    console.debug
      Unmatched recognized word: "fast" (insertion/filler).

      at Aligner.align (src/content/alignment/Aligner.ts:69:17)

    console.debug
      Skipped 1 reference words (paraphrasing/deletion).

      at Aligner.align (src/content/alignment/Aligner.ts:55:19)

    console.debug
      Unmatched recognized word: "very" (insertion/filler).

      at Aligner.align (src/content/alignment/Aligner.ts:69:17)

    console.debug
      Unmatched recognized word: "fast" (insertion/filler).

      at Aligner.align (src/content/alignment/Aligner.ts:69:17)

PASS src/background/AudioCache.test.ts
  ● Console

    console.log
      Result keys: [ 'blob', 'alignment' ]

      at Object.<anonymous> (src/background/AudioCache.test.ts:136:17)

FAIL src/content/ReadingPane.sync.test.tsx
  ● Console

    console.error
      Error: Uncaught [TypeError: activeEl.scrollIntoView is not a function]
          at reportException (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
          at invokeEventListeners (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
          at invokeGuardedCallback (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
          at reportUncaughtErrorInDEV (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
          at captureCommitPhaseError (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27165:5)
          at commitPassiveMountEffects_complete (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24932:9)
          at commitPassiveMountEffects_begin (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
          at commitPassiveMountEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
          at flushPassiveEffectsImpl (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
          at flushPassiveEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
          at /Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:26808:9
          at flushActQueue (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2667:24)
          at act (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2582:11)
          at /Users/jcook/repo/readalong/web/extension/node_modules/@testing-library/react/dist/act-compat.js:46:25
          at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.sync.test.tsx:203:12) {
        detail: TypeError: activeEl.scrollIntoView is not a function
            at /Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.tsx:85:20
            at commitHookEffectListMount (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
            at commitPassiveMountOnFiber (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
            at commitPassiveMountEffects_complete (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
            at commitPassiveMountEffects_begin (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
            at commitPassiveMountEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
            at flushPassiveEffectsImpl (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
            at flushPassiveEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
            at /Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:26808:9
            at flushActQueue (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2667:24)
            at act (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2582:11)
            at /Users/jcook/repo/readalong/web/extension/node_modules/@testing-library/react/dist/act-compat.js:46:25
            at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.sync.test.tsx:203:12),
        type: 'unhandled exception'
      }

      201 |
      202 |         // Simulate start
    > 203 |         act(() => {
          |            ^
      204 |             if (utterance.onstart) utterance.onstart();
      205 |         });
      206 |

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at reportUncaughtErrorInDEV (node_modules/react-dom/cjs/react-dom.development.js:22877:5)
      at captureCommitPhaseError (node_modules/react-dom/cjs/react-dom.development.js:27165:5)
      at commitPassiveMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24932:9)
      at commitPassiveMountEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24917:7)
      at commitPassiveMountEffects (node_modules/react-dom/cjs/react-dom.development.js:24905:3)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27078:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at node_modules/react-dom/cjs/react-dom.development.js:26808:9
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.sync.test.tsx:203:12)

    console.error
      The above error occurred in the <ReadingPane> component:
      
          at ReadingPane (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.tsx:23:52)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

      201 |
      202 |         // Simulate start
    > 203 |         act(() => {
          |            ^
      204 |             if (utterance.onstart) utterance.onstart();
      205 |         });
      206 |

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at performSyncWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:26156:3)
      at flushSyncCallbacks (node_modules/react-dom/cjs/react-dom.development.js:12042:22)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27099:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at node_modules/react-dom/cjs/react-dom.development.js:26808:9
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.sync.test.tsx:203:12)

    console.warn
      Offscreen playback failed, switching to fallback Error: Force fallback
          at /Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:191:40
          at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.sync.test.tsx:167:25)
          at /Users/jcook/repo/readalong/web/extension/node_modules/jest-mock/build/index.js:397:39
          at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/node_modules/jest-mock/build/index.js:404:13)
          at Object.mockConstructor [as sendMessage] (/Users/jcook/repo/readalong/web/extension/node_modules/jest-mock/build/index.js:108:19)
          at /Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:185:40
          at new Promise (<anonymous>)
          at ElevenLabsProvider.playChunk (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:184:27)
          at ElevenLabsProvider.play (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:147:9)

      196 |                     });
      197 |                 } catch (err) {
    > 198 |                     console.warn("Offscreen playback failed, switching to fallback", err);
          |                             ^
      199 |                     this.useFallback = true;
      200 |                     await this.playLocalAudio(chunk.audioId!, startTime);
      201 |                 }

      at ElevenLabsProvider.playChunk (src/content/providers/ElevenLabsProvider.ts:198:29)
      at ElevenLabsProvider.play (src/content/providers/ElevenLabsProvider.ts:147:9)

    console.error
      ElevenLabs Playback Error TypeError: ElevenLabsClient_1.ElevenLabsClient.fetchAudio is not a function
          at ElevenLabsProvider.playLocalAudio (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:236:51)
          at ElevenLabsProvider.playChunk (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:200:32)
          at ElevenLabsProvider.play (/Users/jcook/repo/readalong/web/extension/src/content/providers/ElevenLabsProvider.ts:147:9)

      210 |
      211 |         } catch (err) {
    > 212 |             console.error("ElevenLabs Playback Error", err);
          |                     ^
      213 |             if (this.onError) this.onError(String(err));
      214 |             if (this.onStateChange) this.onStateChange(false, false);
      215 |         }

      at ElevenLabsProvider.playChunk (src/content/providers/ElevenLabsProvider.ts:212:21)
      at ElevenLabsProvider.play (src/content/providers/ElevenLabsProvider.ts:147:9)

    console.error
      Provider Error TypeError: ElevenLabsClient_1.ElevenLabsClient.fetchAudio is not a function

      368 |       };
      369 |       provider.onError = (err) => {
    > 370 |         console.error("Provider Error", err);
          |                 ^
      371 |         setIsLoadingAudio(false);
      372 |       };
      373 |

      at ElevenLabsProvider.provider.onError (src/content/ReadingPane.tsx:370:17)
      at ElevenLabsProvider.playChunk (src/content/providers/ElevenLabsProvider.ts:213:36)
      at ElevenLabsProvider.play (src/content/providers/ElevenLabsProvider.ts:147:9)

    console.error
      Error: Uncaught [TypeError: activeEl.scrollIntoView is not a function]
          at reportException (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:66:24)
          at innerInvokeEventListeners (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
          at invokeEventListeners (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
          at HTMLUnknownElementImpl._dispatch (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
          at HTMLUnknownElementImpl.dispatchEvent (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
          at HTMLUnknownElement.dispatchEvent (/Users/jcook/repo/readalong/web/extension/node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
          at Object.invokeGuardedCallbackDev (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:4213:16)
          at invokeGuardedCallback (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:4277:31)
          at reportUncaughtErrorInDEV (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:22877:5)
          at captureCommitPhaseError (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27165:5)
          at commitPassiveMountEffects_complete (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24932:9)
          at commitPassiveMountEffects_begin (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
          at commitPassiveMountEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
          at flushPassiveEffectsImpl (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
          at flushPassiveEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
          at /Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:26808:9
          at flushActQueue (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2667:24)
          at act (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2582:11)
          at /Users/jcook/repo/readalong/web/extension/node_modules/@testing-library/react/dist/act-compat.js:46:25
          at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.sync.test.tsx:260:12) {
        detail: TypeError: activeEl.scrollIntoView is not a function
            at /Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.tsx:85:20
            at commitHookEffectListMount (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
            at commitPassiveMountOnFiber (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
            at commitPassiveMountEffects_complete (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
            at commitPassiveMountEffects_begin (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
            at commitPassiveMountEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
            at flushPassiveEffectsImpl (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
            at flushPassiveEffects (/Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
            at /Users/jcook/repo/readalong/web/extension/node_modules/react-dom/cjs/react-dom.development.js:26808:9
            at flushActQueue (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2667:24)
            at act (/Users/jcook/repo/readalong/web/extension/node_modules/react/cjs/react.development.js:2582:11)
            at /Users/jcook/repo/readalong/web/extension/node_modules/@testing-library/react/dist/act-compat.js:46:25
            at Object.<anonymous> (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.sync.test.tsx:260:12),
        type: 'unhandled exception'
      }

      258 |         // Simulate time update on the Audio element
      259 |         // Time 0.1 -> 'H' -> Index 0 ("Hello")
    > 260 |         act(() => {
          |            ^
      261 |             audioInstance.currentTime = 0.15;
      262 |             audioInstance._trigger('timeupdate');
      263 |         });

      at VirtualConsole.<anonymous> (node_modules/jest-environment-jsdom/build/index.js:63:23)
      at reportException (node_modules/jsdom/lib/jsdom/living/helpers/runtime-script-errors.js:70:28)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:353:9)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at reportUncaughtErrorInDEV (node_modules/react-dom/cjs/react-dom.development.js:22877:5)
      at captureCommitPhaseError (node_modules/react-dom/cjs/react-dom.development.js:27165:5)
      at commitPassiveMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24932:9)
      at commitPassiveMountEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24917:7)
      at commitPassiveMountEffects (node_modules/react-dom/cjs/react-dom.development.js:24905:3)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27078:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at node_modules/react-dom/cjs/react-dom.development.js:26808:9
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.sync.test.tsx:260:12)

    console.error
      The above error occurred in the <ReadingPane> component:
      
          at ReadingPane (/Users/jcook/repo/readalong/web/extension/src/content/ReadingPane.tsx:23:52)
      
      Consider adding an error boundary to your tree to customize error handling behavior.
      Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

      258 |         // Simulate time update on the Audio element
      259 |         // Time 0.1 -> 'H' -> Index 0 ("Hello")
    > 260 |         act(() => {
          |            ^
      261 |             audioInstance.currentTime = 0.15;
      262 |             audioInstance._trigger('timeupdate');
      263 |         });

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:18704:23)
      at update.callback (node_modules/react-dom/cjs/react-dom.development.js:18737:5)
      at callCallback (node_modules/react-dom/cjs/react-dom.development.js:15036:12)
      at commitUpdateQueue (node_modules/react-dom/cjs/react-dom.development.js:15057:9)
      at commitLayoutEffectOnFiber (node_modules/react-dom/cjs/react-dom.development.js:23430:13)
      at commitLayoutMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24727:9)
      at commitLayoutEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24713:7)
      at commitLayoutEffects (node_modules/react-dom/cjs/react-dom.development.js:24651:3)
      at commitRootImpl (node_modules/react-dom/cjs/react-dom.development.js:26862:5)
      at commitRoot (node_modules/react-dom/cjs/react-dom.development.js:26721:5)
      at performSyncWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:26156:3)
      at flushSyncCallbacks (node_modules/react-dom/cjs/react-dom.development.js:12042:22)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27099:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at node_modules/react-dom/cjs/react-dom.development.js:26808:9
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.sync.test.tsx:260:12)

  ● ReadingPane Synchronization › Syncs TTS highlighting using onboundary events

    TypeError: activeEl.scrollIntoView is not a function

      83 |         // We use a small buffer (e.g. 5px) to handle sub-pixel rendering issues
      84 |         if (activeRect.bottom > containerRect.bottom - 5) {
    > 85 |           activeEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
         |                    ^
      86 |         }
      87 |         // Optional: Also handle if it's above the top (e.g. user scrolled up or back nav)
      88 |         else if (activeRect.top < containerRect.top) {

      at src/content/ReadingPane.tsx:85:20
      at commitHookEffectListMount (node_modules/react-dom/cjs/react-dom.development.js:23189:26)
      at commitPassiveMountOnFiber (node_modules/react-dom/cjs/react-dom.development.js:24970:11)
      at commitPassiveMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24930:9)
      at commitPassiveMountEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24917:7)
      at commitPassiveMountEffects (node_modules/react-dom/cjs/react-dom.development.js:24905:3)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27078:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at node_modules/react-dom/cjs/react-dom.development.js:26808:9
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.sync.test.tsx:203:12)

  ● ReadingPane Synchronization › Syncs ElevenLabs highlighting using alignment data

    TypeError: activeEl.scrollIntoView is not a function

      83 |         // We use a small buffer (e.g. 5px) to handle sub-pixel rendering issues
      84 |         if (activeRect.bottom > containerRect.bottom - 5) {
    > 85 |           activeEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
         |                    ^
      86 |         }
      87 |         // Optional: Also handle if it's above the top (e.g. user scrolled up or back nav)
      88 |         else if (activeRect.top < containerRect.top) {

      at src/content/ReadingPane.tsx:85:20
      at commitHookEffectListMount (node_modules/react-dom/cjs/react-dom.development.js:23189:26)
      at commitPassiveMountOnFiber (node_modules/react-dom/cjs/react-dom.development.js:24970:11)
      at commitPassiveMountEffects_complete (node_modules/react-dom/cjs/react-dom.development.js:24930:9)
      at commitPassiveMountEffects_begin (node_modules/react-dom/cjs/react-dom.development.js:24917:7)
      at commitPassiveMountEffects (node_modules/react-dom/cjs/react-dom.development.js:24905:3)
      at flushPassiveEffectsImpl (node_modules/react-dom/cjs/react-dom.development.js:27078:3)
      at flushPassiveEffects (node_modules/react-dom/cjs/react-dom.development.js:27023:14)
      at node_modules/react-dom/cjs/react-dom.development.js:26808:9
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.sync.test.tsx:260:12)

PASS src/content/extractor.test.ts
PASS src/content/audio/AudioRecorder.test.ts
PASS src/content/ReadingPane.test.tsx
  ● Console

    console.error
      Failed to load voices Invalid API Key

      171 |         .then(voices => setClonedVoices(voices))
      172 |         .catch(err => {
    > 173 |           console.error("Failed to load voices", err);
          |                   ^
      174 |           setVoiceFetchError(typeof err === 'string' ? err : (err.message || String(err)));
      175 |         })
      176 |         .finally(() => setIsLoadingVoices(false));

      at src/content/ReadingPane.tsx:173:19

PASS src/content/ReadingPane.settings.test.tsx
  ● Console

    console.warn
      ElevenLabs selected but missing config.

      321 |         provider = new ElevenLabsProvider(alignmentMap, elevenLabsApiKey, selectedVoiceId);
      322 |       } else {
    > 323 |         console.warn("ElevenLabs selected but missing config.");
          |                 ^
      324 |         alert("Please configure ElevenLabs API Key and Voice in Settings.");
      325 |         return null;
      326 |       }

      at initProvider (src/content/ReadingPane.tsx:323:17)
      at handleReadAloud (src/content/ReadingPane.tsx:392:22)
      at onClick (src/content/ReadingPane.tsx:508:32)
      at HTMLUnknownElement.callCallback (node_modules/react-dom/cjs/react-dom.development.js:4164:14)
      at HTMLUnknownElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at invokeGuardedCallbackAndCatchFirstError (node_modules/react-dom/cjs/react-dom.development.js:4291:25)
      at executeDispatch (node_modules/react-dom/cjs/react-dom.development.js:9041:3)
      at processDispatchQueueItemsInOrder (node_modules/react-dom/cjs/react-dom.development.js:9073:7)
      at processDispatchQueue (node_modules/react-dom/cjs/react-dom.development.js:9086:5)
      at dispatchEventsForPlugins (node_modules/react-dom/cjs/react-dom.development.js:9097:3)
      at node_modules/react-dom/cjs/react-dom.development.js:9288:12
      at batchedUpdates$1 (node_modules/react-dom/cjs/react-dom.development.js:26179:12)
      at batchedUpdates (node_modules/react-dom/cjs/react-dom.development.js:3991:12)
      at dispatchEventForPluginEventSystem (node_modules/react-dom/cjs/react-dom.development.js:9287:3)
      at dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay (node_modules/react-dom/cjs/react-dom.development.js:6465:5)
      at dispatchEvent (node_modules/react-dom/cjs/react-dom.development.js:6457:5)
      at dispatchDiscreteEvent (node_modules/react-dom/cjs/react-dom.development.js:6430:5)
      at HTMLDivElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLButtonElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at fireAnEvent (node_modules/jsdom/lib/jsdom/living/helpers/events.js:18:36)
      at HTMLButtonElementImpl.click (node_modules/jsdom/lib/jsdom/living/nodes/HTMLElement-impl.js:79:5)
      at HTMLButtonElement.click (node_modules/jsdom/lib/jsdom/living/generated/HTMLElement.js:108:34)
      at src/content/ReadingPane.settings.test.tsx:183:23
      at node_modules/@testing-library/react/dist/act-compat.js:47:24
      at act (node_modules/react/cjs/react.development.js:2512:16)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.settings.test.tsx:182:12)

    console.warn
      Google selected but missing config.

      332 |         provider = new GoogleProvider(alignmentMap, googleApiKey, selectedVoice);
      333 |       } else {
    > 334 |         console.warn("Google selected but missing config.");
          |                 ^
      335 |         alert("Please configure Google Cloud API Key and Voice in Settings.");
      336 |         return null;
      337 |       }

      at initProvider (src/content/ReadingPane.tsx:334:17)
      at handleReadAloud (src/content/ReadingPane.tsx:392:22)
      at onClick (src/content/ReadingPane.tsx:508:32)
      at HTMLUnknownElement.callCallback (node_modules/react-dom/cjs/react-dom.development.js:4164:14)
      at HTMLUnknownElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLUnknownElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at HTMLUnknownElementImpl.dispatchEvent (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:104:17)
      at HTMLUnknownElement.dispatchEvent (node_modules/jsdom/lib/jsdom/living/generated/EventTarget.js:241:34)
      at Object.invokeGuardedCallbackDev (node_modules/react-dom/cjs/react-dom.development.js:4213:16)
      at invokeGuardedCallback (node_modules/react-dom/cjs/react-dom.development.js:4277:31)
      at invokeGuardedCallbackAndCatchFirstError (node_modules/react-dom/cjs/react-dom.development.js:4291:25)
      at executeDispatch (node_modules/react-dom/cjs/react-dom.development.js:9041:3)
      at processDispatchQueueItemsInOrder (node_modules/react-dom/cjs/react-dom.development.js:9073:7)
      at processDispatchQueue (node_modules/react-dom/cjs/react-dom.development.js:9086:5)
      at dispatchEventsForPlugins (node_modules/react-dom/cjs/react-dom.development.js:9097:3)
      at node_modules/react-dom/cjs/react-dom.development.js:9288:12
      at batchedUpdates$1 (node_modules/react-dom/cjs/react-dom.development.js:26179:12)
      at batchedUpdates (node_modules/react-dom/cjs/react-dom.development.js:3991:12)
      at dispatchEventForPluginEventSystem (node_modules/react-dom/cjs/react-dom.development.js:9287:3)
      at dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay (node_modules/react-dom/cjs/react-dom.development.js:6465:5)
      at dispatchEvent (node_modules/react-dom/cjs/react-dom.development.js:6457:5)
      at dispatchDiscreteEvent (node_modules/react-dom/cjs/react-dom.development.js:6430:5)
      at HTMLDivElement.callTheUserObjectsOperation (node_modules/jsdom/lib/jsdom/living/generated/EventListener.js:26:30)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at HTMLButtonElementImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at fireAnEvent (node_modules/jsdom/lib/jsdom/living/helpers/events.js:18:36)
      at HTMLButtonElementImpl.click (node_modules/jsdom/lib/jsdom/living/nodes/HTMLElement-impl.js:79:5)
      at HTMLButtonElement.click (node_modules/jsdom/lib/jsdom/living/generated/HTMLElement.js:108:34)
      at src/content/ReadingPane.settings.test.tsx:216:23
      at node_modules/@testing-library/react/dist/act-compat.js:47:24
      at act (node_modules/react/cjs/react.development.js:2512:16)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at Object.<anonymous> (src/content/ReadingPane.settings.test.tsx:215:12)

PASS src/content/ReadingPane.voices.test.tsx
  ● Console

    console.log
      Refreshed voices: found 1

      at handleRefreshVoices (src/content/ReadingPane.tsx:157:13)

    console.log
      Microsoft Refresh (en-US)

      at handleRefreshVoices (src/content/ReadingPane.tsx:158:13)


Test Suites: 1 failed, 15 passed, 16 total
Tests:       2 failed, 66 passed, 68 total
Snapshots:   0 total
Time:        5.844 s
Ran all test suites.
